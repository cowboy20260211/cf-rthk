# 播放器"现正播放"内容显示更新

## 更新说明

已在播放器中添加"现正播放"标签和完整的节目信息显示。

## 新增功能

### 1. 直播标签

```
[LIVE] 现正播放
```

- 红色背景的 "LIVE" 标签
- "现正播放" 文字标识
- 只在直播模式显示

### 2. 完整节目信息

#### 直播模式

```
现正播放
輕談淺唱不夜天
主持: 劉沛龍  02:00-06:00
```

#### 点播模式

```
輕談淺唱不夜天
2026-02-18 足本重溫
```

### 3. 错误状态显示

```
连接中断，正在重试 (1/3)...
```

## UI布局

### 直播播放器 (高度: 50px)

```
┌─────────────────────────────────────────┐
│ [LIVE] 现正播放              [▶/⏸]      │
│ 輕談淺唱不夜天                          │
│ 主持: 劉沛龍  02:00-06:00               │
└─────────────────────────────────────────┘
```

### 点播播放器 (高度: 80px)

```
┌─────────────────────────────────────────┐
│ 輕談淺唱不夜天              [▶/⏸]      │
│ 2026-02-18 足本重溫                    │
│ ━━━━━━━━●━━━━━━━━ 15:32 / 4:00:00     │
└─────────────────────────────────────────┘
```

## 实现细节

### 状态管理

```typescript
const [liveProgramInfo, setLiveProgramInfo] = useState<{
  program: string; // 节目名称
  host: string; // 主持人
  time: string; // 播出时间
} | null>(null);
```

### 数据获取

```typescript
useEffect(() => {
  if (currentChannel?.id) {
    fetchCurrentLiveProgram(currentChannel.id)
      .then(info => setLiveProgramInfo(info))
      .catch(() => setLiveProgramInfo(null));
  }
}, [currentChannel?.id]);
```

### 显示逻辑

```typescript
{isLive && (
  <div>
    <span>LIVE</span>
    <span>现正播放</span>
  </div>
)}

<div>节目名称: {liveProgramInfo?.program}</div>
<div>主持: {liveProgramInfo?.host} | {liveProgramInfo?.time}</div>
```

## 数据来源

### fetchCurrentLiveProgram()

- URL: `https://www.rthk.hk/timetable/{channelId}`
- 缓存: 5分钟
- 解析: 当前时段的节目信息

### 返回数据

```typescript
{
  program: "輕談淺唱不夜天",
  host: "劉沛龍",
  time: "02:00-06:00"
}
```

## 样式设计

### LIVE标签

- 背景: `#d40000` (RTHK红色)
- 文字: 白色
- 大小: 9px
- 内边距: `2px 6px`
- 圆角: 3px

### "现正播放"文字

- 颜色: `#d40000`
- 大小: 9px
- 粗体

### 节目名称

- 大小: 13px (直播) / 14px (点播)
- 粗体
- 单行显示，超出省略

### 主持人/时间

- 大小: 11px
- 颜色: `#666`
- 单行显示，超出省略

## 优势

### 1. 信息完整

- 显示节目名称
- 显示主持人信息
- 显示播出时间段

### 2. 视觉清晰

- LIVE标签醒目
- 信息层次分明
- 颜色搭配合理

### 3. 用户体验

- 一目了然当前播放内容
- 快速了解节目信息
- 专业感强

## 测试验证

### 本地测试

```bash
npm run dev:full
```

### 测试步骤

1. 访问 `http://localhost:3000`
2. 点击任意直播频道
3. 观察播放器显示：
   - ✅ LIVE 标签显示
   - ✅ "现正播放" 文字显示
   - ✅ 节目名称显示
   - ✅ 主持人信息显示
   - ✅ 播出时间显示

### 验证要点

- 直播模式显示LIVE标签
- 节目信息正确加载
- 布局美观不溢出
- 点播模式不受影响

## 对比

### 之前

```
輕談淺唱不夜天
劉沛龍
```

### 现在

```
[LIVE] 现正播放
輕談淺唱不夜天
主持: 劉沛龍  02:00-06:00
```

## 相关文件

| 文件                                    | 更新内容         |
| --------------------------------------- | ---------------- |
| `src/components/Player/AudioPlayer.tsx` | UI布局和样式更新 |

## 未来改进

- [ ] 添加节目图片
- [ ] 添加节目简介
- [ ] 添加下一节目预告
- [ ] 添加节目收藏功能
- [ ] 添加分享功能
